Q1(Question 1 , Question set 1)/*Create a query that lists each movie, the film category it is classified in, and the number of times it has been rented out*/Select fm.title,ctg.name AS category_name,count(rl.customer_id)from rental as rljoin inventory as invy ONrl.inventory_id=invy.inventory_idJOIN film as fm ONinvy.film_id =fm.film_id JOIN film_category as fm_ctg onfm.film_id = fm_ctg.film_id JOIN category as ctg  onfm_ctg.category_id = ctg.category_idwhere ctg.name in ('Animation','Children','Classics','Comedy','Family','Music')/*family movies*/GROUP BY fm.title,ctg.nameORDER BY fm.title ASC;Q2:SQL/*Can you provide a table with the movie titles and divide them into 4 levels (first_quarter, second_quarter, third_quarter, and final_quarter) based on the quartiles (25%, 50%, 75%) of the rental duration for movies across all categories?*/Select fm.title,ctg.name AS name, fm.rental_duration ,NTILE(4) OVER (PARTITION BY ctg.name ORDER BY fm.rental_duration) AS standard_quartilefrom film as fm JOIN film_category as fm_ctg onfm.film_id = fm_ctg.film_id JOIN category as ctg  onfm_ctg.category_id = ctg.category_idwhere ctg.name in ('Animation','Children','Classics','Comedy','Family','Music')/*family movies*/Q3(Question 1 , Question set 2)/*Write a query that returns the store ID for the store, the year and month and the number of rental orders each store has fulfilled for that month. Your table should include a column for each of the following: year, month, store ID and count of rental orders fulfilled during that month*/SELECT EXTRACT(MONTH FROM r.rental_date)as Rental_month, EXTRACT(Year FROM r.rental_date)as Rental_year, t.store_id as Store_ID,count(r.rental_id)as Count_rentalsFROM rental r JOIN staff sON r.staff_id = s.staff_idJOIN store tON s.store_id = t.store_idGroup by EXTRACT(MONTH FROM r.rental_date), EXTRACT(Year FROM r.rental_date), t.store_idQ4(Question 2 , Question set 2)/*Can you write a query to capture the customer name, month and year of payment, and total payment amount for each month by these top 10 paying customers?*/WITH QW1 AS (SELECT customer.customer_id,CONCAT(customer.first_name,' ',customer.last_name) as fullname,SUM(payment.amount),COUNT(payment.amount)FROM paymentJOIN customer ON payment.customer_id = customer.customer_idGROUP BY customer.customer_id,CONCAT(customer.first_name,' ',customer.last_name)ORDER BY SUM(payment.amount)  DESCFETCH FIRST 10 ROWS ONLY ),QW2 AS (SELECT DATE_TRUNC('month', payment_date) AS pay_mon, CONCAT(customer.first_name,' ',customer.last_name) as fullname, COUNT(payment.amount) AS pay_countpermon, SUM(payment.amount) AS pay_amountFROM QW1JOIN payment ON QW1.customer_id = payment.customer_idJOIN customer ON payment.customer_id = customer.customer_idGROUP BY pay_mon, CONCAT(customer.first_name,' ',customer.last_name)ORDER BY fullname, pay_mon)select *from QW2References:https://www.w3schools.com/sql/https://www.seancarney.ca/2021/01/31/calculating-medians-and-quartiles-across-groups-in-sql/ https://stackoverflow.com/ https://www.mysql.com/